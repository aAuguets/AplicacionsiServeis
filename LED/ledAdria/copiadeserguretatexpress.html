<!DOCTYPE HTML>
<html>
<head>
  <link rel="stylesheet" type="text/css" href="estil.css">
  <meta charset='utf-8'>
<TITLE>Programa Javascript</TITLE>
</head>
<body>
  <ul>
    <li><a href="index.html">Home</a></li>
    <li><a href="membres.html">Membres</a></li>
    <li><a href="interes.html">Webs d'Inter√©s</a></li>
    <li><a href="fotos.html">Fotos</a></li>
    <li><a href="formulari.html">Solicitud d'amistat</a></li>
    <li><a href="javascript.html">Javascript</a></li>
  </ul>
  <h1> Led Arduino v2</h1>
  <p>
      <div id="myDiv" style="color:#f2f2f2"><center><font size="42">LED!</font></center></div>
      <center>
      <input type="submit" value="On" id="boto_enviar" onclick="send_on()"/>
      <input type="reset" value="Off" id="boto_reset" onclick="send_off()"/>
      <input type="submit" value="Actualitza estat" id="boto_comprova" onclick="status()"/>
      </center>
    </p>

<script>
setInterval("loadXMLDoc()",10000);

function send_on(){
  var xmlhttp;
  xmlhttp = new XMLHttpRequest();
  xmlhttp.open("GET", "http://www.g7.asi.itic.cat/led/led_on", true);
  xmlhttp.send();
  loadXMLDoc();
}

function send_off(){
  var xmlhttp;
  xmlhttp = new XMLHttpRequest();
  xmlhttp.open("GET", "http://www.g7.asi.itic.cat/led/led_off", true);
  xmlhttp.send();
  loadXMLDoc();
}

function status(){
  var xmlhttp;
  xmlhttp = new XMLHttpRequest();
  xmlhttp.open("GET", "http://www.g7.asi.itic.cat/led/estat", true);
  xmlhttp.send();
  loadXMLDoc();
}


function loadXMLDoc()
{
  var xmlhttp;
  var objecte_div;
  objecte_div=document.getElementById("myDiv");
  xmlhttp=new XMLHttpRequest();
  xmlhttp.onreadystatechange=function()
  {
  if (xmlhttp.readyState==4 /*&& xmlhttp.status==200*/)
    {
    console.log("Update data",xmlhttp.responseText);
    if(xmlhttp.responseText==1){
      objecte_div.style.color="green";
    }
    else {
      objecte_div.style.color="#f2f2f2";
    }
    }
  }
  xmlhttp.open("GET","http://www.g7.asi.itic.cat/led/estat",true);
  xmlhttp.send();
} </script>
  </body>
</html>
